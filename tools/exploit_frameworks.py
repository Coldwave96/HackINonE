# coding=utf-8
from core import HackINonE
from core import HackINonECollection
from tools.webattack import Web2Attack


class RouterSploit(HackINonE):
    TITLE = "RouterSploit"
    DESCRIPTION = "The RouterSploit Framework is an open-source exploitation " \
                  "framework dedicated to embedded devices"
    INSTALL_COMMANDS = [
        "sudo git clone https://github.com/threat9/routersploit.git",
        "cd routersploit && sudo python3 -m pip install -r requirements.txt"
    ]
    RUN_COMMANDS = ["cd routersploit && sudo python3 rsf.py"]
    PROJECT_URL = "https://github.com/threat9/routersploit"


class WebSploit(HackINonE):
    TITLE = "WebSploit"
    DESCRIPTION = "Websploit is an advanced MITM framework."
    INSTALL_COMMANDS = ["https://github.com/The404Hacking/websploit.git"]
    RUN_COMMANDS = ["cd websploit;python3 websploit.py"]
    PROJECT_URL = "https://github.com/The404Hacking/websploit "


class Commix(HackINonE):
    TITLE = "Commix"
    DESCRIPTION = "Automated All-in-One OS command injection and exploitation " \
                  "tool.\nCommix can be used from web developers, penetration " \
                  "testers or even security researchers\n in order to test " \
                  "web-based applications with the view to find bugs,\n " \
                  "errors or vulnerabilities related to command injection " \
                  "attacks.\n Usage: python commix.py [option(s)]"
    INSTALL_COMMANDS = ["git clone https://github.com/commixproject/commix.git commix"]
    PROJECT_URL = "https://github.com/commixproject/commix"

    def __init__(self):
        super(Commix, self).__init__(runnable=False)


class Nettacker(HackINonE):
    TITLE = "OWASP-Nettacker"
    DESCRIPTION = "Automated Penetration Testing Framework"
    INSTALL_COMMANDS = [
        "git clone https://github.com/zdresearch/OWASP-Nettacker.git",
        "cd OWASP-Nettacker && pip install -r requirements.txt && python setup.py install"
    ]
    RUN_COMMANDS = ["nettacker"]
    PROJECT_URL = "https://github.com/zdresearch/OWASP-Nettacker"


class NosqlFramework(HackINonE):
    TITLE = "NoSQL Exploitation Framework"
    DESCRIPTION = "A Python Framework For NoSQL Scanning and Exploitation."
    INSTALL_COMMANDS = [
        "git clone https://github.com/torque59/Nosql-Exploitation-Framework.git",
        "cd Nosql-Exploitation-Framework && pip install -r requirements.txt"
    ]
    RUN_COMMANDS = ["sudo python nosqlframework.py -h"]
    PROJECT_URL = "https://github.com/torque59/Nosql-Exploitation-Framework"


class ExploitFrameworkTools(HackINonECollection):
    TITLE = "Exploit framework"
    TOOLS = [
        RouterSploit(),
        WebSploit(),
        Commix(),
        Web2Attack(),
        Nettacker(),
        NosqlFramework()
    ]
